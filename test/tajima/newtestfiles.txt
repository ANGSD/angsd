From version 0.917 i updated to binary theta files. This files describe and compare the two formats.

1) checkout dev branch


[fvr124@zl08368 angsd]$ git checkout safglAsLog
Switched to branch 'safglAsLog'
[fvr124@zl08368 angsd]$ make clean &>/dev/null ;make HTSSRC=../hts &>/dev/null
[fvr124@zl08368 angsd]$ cd test;./testTaj.sh ../;
[fvr124@zl08368 test]$ ../misc/thetaStat print tajima/output/norm.thetas.idx >/tmp/norm.thetas.new;../misc/thetaStat print tajima/output/fold.thetas.idx >/tmp/fold.thetas.new
ret:tajima/output/norm.thetas.gz
Assuming binfile:tajima/output/norm.thetas.gz and indexfile:tajima/output/norm.thetas.idx
		Information from index file:
		0	1	264256	34359738408	270792352
pc.chr=1 pc.nSites=264256 pc.nChr=40 firstpos=0 lastpos=264255
ret:tajima/output/fold.thetas.gz
Assuming binfile:tajima/output/fold.thetas.gz and indexfile:tajima/output/fold.thetas.idx
		Information from index file:
		0	1	264256	34359738388	1741817504
pc.chr=1 pc.nSites=264256 pc.nChr=20 firstpos=0 lastpos=264255
[fvr124@zl08368 test]$ 


2) checkout master branch

[fvr124@zl08368 angsd]$  git checkout master;make clean &>/dev/null ;make HTSSRC=../hts &>/dev/null; cd test;./testTaj.sh ../;
Switched to branch 'master'



> b<-read.table("/tmp/norm.thetas.new")
> a<-read.table("test/tajima/output/norm.thetas.gz")
> table(a[,1:2]!=b[,1:2])

 FALSE 
528512 
> a<-exp(a[,-c(1:2)])
> b<-exp(b[,-c(1:2)])
> range(abs(a-b))
[1] 0.000000e+00 1.949447e-06
> colSums(a)
      V3       V4       V5       V6       V7 
62119.94 55291.98 69243.38 98842.39 77067.18 
> colSums(b)
      V3       V4       V5       V6       V7 
62119.94 55291.98 69243.38 98842.39 77067.18 


> b<-read.table("/tmp/fold.thetas.new")
> a<-read.table("test/tajima/output/fold.thetas.gz")
> table(a[,1:2]!=b[,1:2])

 FALSE 
528512 
> a<-exp(a[,-c(1:2)])
> b<-exp(b[,-c(1:2)])
> range(abs(a-b))
[1] 0.000000e+00 5.127061e-07
> colSums(b)
      V3       V4       V5       V6       V7 
62121.55 55292.36     0.00     0.00     0.00 
> colSums(a)
      V3       V4       V5       V6       V7 
62121.55 55292.36     0.00     0.00     0.00 

#fullc omparison:

[fvr124@zl08368 angsd]$ seq 22 >rf
[fvr124@zl08368 angsd]$ ./angsd -b list -rf rf -anc ../hg19ancNoChr.fa.gz -gl 1 -dosaf 1 -out forprior

./misc/realSFS  forprior.saf.idx  >forprior.ml

[fvr124@zl08368 angsd]$ git branch
  master
  newsaf2
* safglAsLog
[fvr124@zl08368 angsd]$ ./angsd -b list -rf rf -anc ../hg19ancNoChr.fa.gz -gl 1 -dosaf 1 -out new -dothetas 1 -pest forprior.ml

[fvr124@zl08368 angsd]$ ./angsd -b list -rf rf -anc ../hg19ancNoChr.fa.gz -gl 1 -dosaf 1 -out new -dothetas 1 -pest forprior.ml 2>/dev/null
 
[fvr124@zl08368 angsd]$ 
[fvr124@zl08368 angsd]$ ./misc/thetaStat print new.thetas.idx >new.thetas.txt

git checkout master
make clean;make HTSSRC=../hts

./angsd -b list -rf rf -anc ../hg19ancNoChr.fa.gz -gl 1 -dosaf 1 -out original -dothetas 1 -pest forprior.ml 

[fvr124@zl08368 angsd]$ R

R version 3.3.1 (2016-06-21) -- "Bug in Your Hair"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> a<-read.table("original.thetas.gz");b<-read.table("new.thetas.txt")

> table(a[,1:2]!=b[,1:2])

  FALSE 
3334150 
> colSums(exp(a[,-c(1:2)])
+ 
> colSums(exp(a[,-c(1:2)]))
          V3           V4           V5           V6           V7 
1.118337e+03 1.484958e+03 2.190044e-02 1.853120e+03 1.669039e+03 
> colSums(exp(b[,-c(1:2)]))
          V3           V4           V5           V6           V7 
1.118337e+03 1.484958e+03 2.190044e-02 1.853120e+03 1.669039e+03 
> colSums(exp(b[,-c(1:2)]))-colSums(exp(a[,-c(1:2)]))
           V3            V4            V5            V6            V7 
-2.326379e-06 -1.756357e-06  9.158794e-11  1.506844e-06  2.727703e-06 
> 

[fvr124@zl08368 angsd]$ cat test/tajima/output/norm.thetas.gz.pestPG 
#(indexStart,indexStop)(firstPos_withData,lastPos_withData)(WinStart,WinStop)	Chr	WinCenter	tW	tP	tF	tH	tLTajima	fuf	fud	fayh	zeng	nSites
(0,264255)(1,264256)(0,264256)	1	132128	62119.700924	55291.469137	69243.382862	98841.971147	77066.720164	-0.414251	-0.423020	-0.296850	-0.562553	0.195683	264255
[fvr124@zl08368 angsd]$ cat test/tajima/outputNew/norm.thetas.idx.pestPG 
#(indexStart,indexStop)(firstPos_withData,lastPos_withData)(WinStart,WinStop)	Chr	WinCenter	tW	tP	tF	tH	tLTajima	fuf	fud	fayh	zeng	nSites
(0,264255)(0,264255)(0,264255)	1	132127	62119.686074	55291.469147	69243.382919	98841.971148	77066.720148	-0.414250	-0.423020	-0.296850	-0.562553	0.195683	264255

[fvr124@zl08368 angsd]$ cat test/tajima/output/fold.thetas.gz.pestPG 
#(indexStart,indexStop)(firstPos_withData,lastPos_withData)(WinStart,WinStop)	Chr	WinCenter	tW	tP	tF	tH	tLTajima	fuf	fud	fayh	zeng	nSites
(0,264255)(1,264256)(0,264256)	1	132128	62121.313815	55291.849810	0.000000	0.000000	0.000000	-0.414315	1.676397	2.588579	0.714201	-0.813258	264255
[fvr124@zl08368 angsd]$ cat test/tajima/outputNew/fold.thetas.idx.pestPG 
#(indexStart,indexStop)(firstPos_withData,lastPos_withData)(WinStart,WinStop)	Chr	WinCenter	tW	tP	tF	tH	tLTajima	fuf	fud	fayh	zeng	nSites
(0,264255)(0,264255)(0,264255)	1	132127	62121.299219	55291.849749	0.000000	0.000000	0.000000	-0.461508	1.632640	2.294013	0.888461	-1.098844	264255
[fvr124@zl08368 angsd]$ 

Difference in pestPG is explained by the -nChr set to 40 instead of 20 in the old fold:




[fvr124@zl08368 output]$ cat fold.thetas.gz.pestPG 
#(indexStart,indexStop)(firstPos_withData,lastPos_withData)(WinStart,WinStop)	Chr	WinCenter	tW	tP	tF	tH	tL	Tajima	fuf	fud	fayh	zeng	nSites
(0,264255)(1,264256)(0,264256)	1	132128	62121.313815	55291.849810	0.000000	0.000000	0.000000	-0.414315	1.676397	2.588579	0.714201	-0.813258	264255
[fvr124@zl08368 output]$ ../../../misc/thetaStat do_stat fold.thetas.gz -nChr 20
	Assuming binfile:fold.thetas.gz.bin and indexfile:fold.thetas.gz.idx
		Information from index file:
		0	1	264256	0
	 -r=(null) outnames=(null) step: 0 win: 0 nChr:20
	Winsize equals zero or step size equals zero. Will use entire chromosome as window
	pc.chr=1 pc.nSites=264256 firstpos=1 lastpos=264256
	Dumping file: "fold.thetas.gz.pestPG"
[fvr124@zl08368 output]$ cat fold.thetas.gz.pestPG 
#(indexStart,indexStop)(firstPos_withData,lastPos_withData)(WinStart,WinStop)	Chr	WinCenter	tW	tP	tF	tH	tL	Tajima	fuf	fud	fayh	zeng	nSites
(0,264255)(1,264256)(0,264256)	1	132128	62121.313815	55291.849810	0.000000	0.000000	0.000000	-0.461509	1.632640	2.294013	0.888461	-1.098844	264255


Will checkup up on which is correct

